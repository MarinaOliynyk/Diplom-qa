### План автоматизации тестирования комплексного сервиса, взаимодействующего с СУБД и API Банка.
**Задача:**
Тестирование приложения (веб-сервиса), предоставляющего возможности покупки тура с помощью 2-х способов:
1. обычная оплата по дебетовой карте;
2. покупка в кредит по данным банковской карты.

### Автоматизируемые сценарии
**Валидные данные для формы оплаты:**

- Поле "Номер карты": ввод цифрового значения (всего 16 символов) 
- Поле "Месяц": ввод двухзначного значения (от 01 до 12 включительно), месяц должен иметь значение не менее текущего месяца, если год действия карты - текущий год
- Поле "Год": ввод цифрового двухзначного значения(год не должен иметь значение меньше значения текущего года и не превышать 5 лет от текущего года)
- Поле "Владелец": буквы латинского алфавита не менее 1 символа
- Поле "CVC/CVV": цифровое трёхзначное число (от 000 до 999)

**Тестовые данные:**
- Банковская карта (далее "карта"), для оплаты с номером "4444 4444 4444 4441", статус "APPROVED"
- Банковская карта (далее "карта"), для оплаты с номером "4444 4444 4444 4442", статус "DECLINED"

**Предусловие:**
1. Открыть сайт "Путешествие дня" http://localhost:8080
2. Выбрать один из способов покупки тура:
- 1 вариант: с карты - нажать кнопку «Купить»
- 2 вариант: в кредит - нажать кнопку «Купить в кредит»

**1. Успешное отображение формы по нажатию на кнопку "Купить"/"Купить в кредит"**

Шаги:
1. Нажать на кнопку "Купить"

ОР: отображается форма заполнения полей "Оплата по карте"

**2. Успешная покупка по клику на кнопку "Купить"/"Купить в кредит"**

Шаги:
1. Нажать на кнопку "Купить"
2. Ввести в поле "Номер карты" валидный номер (например, 4444 4444 4444 4441).
3. Ввести в поле "Месяц" номер месяца (например, 07).
4. Ввести в поле "Год" последние 2 цифры года (например, 24).
5. Ввести в поле "Владелец" валидное имя на латинице (например, Marina Oliynyk).
6. Ввести в поле "CVC/CVV" 3-х значный номер (например, 012).
7. Нажать на кнопку "Продолжить".

ОР: все поля формы заполняются валидными данными. Запрос отправляется успешно. На экране появилось всплывающее окно «Успешно» с надписью "Операция одобрена Банком.", в БД добавилась запись со статусом APPROVED.

**3. Отклоненная банком оплата по карте (для обеих форм)**

Шаги:
1. Ввести в поле "Номер карты" невалидный номер (например, 4444 4444 4444 4442).
2. Ввести валидные данные в поля: "Месяц", "Год", "Владелец", "CVC/CVV". 
3. Нажать на кнопку "Продолжить".

ОР: все поля формы заполнены. Ошибка при запросе, на экране сообщение об ошибочной операции: "Ошибка! Банк отказал в проведении операции", в БД добавилась запись со статусом DECLINED.

**4. Отклоненная банком оплата по несуществующей карте стороннего банка (для обеих форм)**

Шаги:
1. Ввести в поле "Номер карты стороннего банка" номер несуществующей карты стороннего банка (например, 4272 3000 0925 5304).
2. Ввести валидные данные в поля: "Месяц", "Год", "Владелец", "CVC/CVV".
3. Нажать на кнопку "Продолжить".

ОР: все поля формы заполнены. Ошибка при запросе, на экране сообщение об ошибочной операции: "Ошибка! Банк отказал в проведении операции".

**5. Отправка формы "Оплата по карте"" с незаполненными полями (для обеих форм)**

Шаги:
1. Оставить поля формы незаполненными
2. Нажать на кнопку "Продолжить".

ОР: Под каждым из полей появляется сообщение "Поле обязательно для заполнения", запрос не уходит.

**6. Проверка поля "Номер карты" (негативный сценарий для обеих форм оплаты)**  

Шаги:
1. Ввести в поле "Номер карты" некорректный номер (например, 15 цифр, 4444 4444 4444 444).
2. Ввести валидные данные в поля: "Месяц", "Год", "Владелец", "CVC/CVV".
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Номер карты" появляется сообщение об ошибке красным цветом "Неверный формат", данные не отправляются.

**7. Проверка поля "Месяц" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести в поле "Номер карты" номер (например, 4444 4444 4444 4441).
2. Ввести в поле "Месяц" некорректный номер месяца (например, 21).
3. Ввести валидные данные в поля "Год", "Владелец", "CVC/CVV".
4. Нажать на кнопку "Продолжить".

ОР: Под полем "Месяц" появляется сообщение об ошибке красным цветом "Неверно указан срок действия карты", данные не отправляются.

**8. Проверка поля "Год" (негативный сценарий с прошедшим годом для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Владелец", "CVC/CVV".
2. Ввести в поле "Год" некорректные последние 2 цифры года (например, 20). 
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Год" появляется сообщение об ошибке красным цветом "Истёк срок действия карты", данные не отправляются.

**9. Проверка поля "Год" (негативный сценарий с годом превышающим 5 лет для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Владелец", "CVC/CVV".
2. Ввести в поле "Год" некорректные последние 2 цифры года (например, 27).
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Год" появляется сообщение об ошибке красным цветом "Неверно указан срок действия карты", данные не отправляются.

**10. Проверка невалидности данных (при истекшем месяце текущего года) - для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Владелец", "CVC/CVV".
2. Ввести в поле "Месяц" прошедший месяц текущего года (например, 06)
3. Ввести в поле "Год" последние 2 цифры текущего года (21).
4. Нажать на кнопку "Продолжить".

ОР: Появляется сообщение об ошибке красным цветом "Истёк срок действия карты", данные не отправляются.

**11. Проверка поля "Владелец" (негативный сценарий для обеих форм оплаты)**  

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Год", "CVC/CVV"
2. Ввести в поле "Владелец" некорректное имя на кириллице или любое имя на кириллице (например, Марина Олийнык).
3. Ввести в поле "CVC/CVV" 3-х значный номер (например, 123). 
4. Нажать на кнопку "Продолжить".

ОР: Под полем "Владелец" появляется сообщение об ошибке красным цветом "Неверный формат", данные не отправляются.

**12. Проверка поля "CVC/CVV" (негативный сценарий для обеих форм оплаты)**  

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Год", "Владелец"
2. Ввести в поле "CVC/CVV" некорректный номер (например, 000).
3. Нажать на кнопку "Продолжить".

ОР: Под полем "CVC/CVV" появляется сообщение об ошибке красным цветом "Неверный формат", данные не отправляются.

**13. Проверка пустого поля "Номер карты" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Оставить пустым поле "Номер карты".
2. Ввести валидные данные в поля: "Месяц", "Год", "Владелец", "CVC/CVV".
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Номер карты" появляется сообщение об ошибке красным цветом "Неверный формат", данные не отправляются.

**14. Проверка пустого поля "Месяц" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Год", "Владелец", "CVC/CVV".
2. Оставить поле "Месяц" пустым.
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Месяц" появляется сообщение об ошибке красным цветом "Неверный формат", данные не отправляются.

**15. Проверка ввода 00 в поле "Месяц" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Год", "Владелец", "CVC/CVV".
2. Ввести 00 в поле "Месяц".
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Месяц" появляется сообщение об ошибке красным цветом "Неверный формат месяца", данные не отправляются.

**16. Проверка пустого поля "Год" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Владелец", "CVC/CVV".
2. Оставить поле "Год" пустым.
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Год" появляется сообщение об ошибке красным цветом "Поле обязательно для заполнения", данные не отправляются.

**17. Проверка пустого поля "Владелец" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Год", "CVC/CVV".
2. Оставить поле "Владелец" пустым.
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Владелец" появляется сообщение об ошибке красным цветом "Поле обязательно для заполнения", данные не отправляются.

**18. Проверка поля "Владелец" на ввод символов (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Год", "CVC/CVV".
2. В поле "Владелец" ввести различные символы.
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Владелец" появляется сообщение об ошибке красным цветом "Неверный формат", данные не отправляются.

**19. Проверка пустого поля "CVC/CVV" (негативный сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Год", "Владелец".
2. Оставить поле "CVC/CVV" пустым.
3. Нажать на кнопку "Продолжить".

ОР: Под полем "Владелец" появляется сообщение об ошибке красным цветом "Поле обязательно для заполнения", данные не отправляются.

**20. Проверка нажатия по кнопке "Закрыть" на уведомлении: «Успешно» "Операция одобрена Банком.".(сценарий для обеих форм оплаты)**

Шаги:
1. Ввести валидные данные в поля: "Номер карты", "Месяц", "Год", "Владелец", "CVC/CVV".
2. Нажать на кнопку "Продолжить".
3. Нажать на крестик у всплывающего окна с сообщением: «Успешно» "Операция одобрена Банком."

ОР: уведомление закрыто.

**21. Проверка нажатия по кнопке "Закрыть" на уведомлении: Ошибка! Банк отказал в проведении операции.(сценарий для обеих форм оплаты)**

Шаги:
1. Ввести невалидный номер поле: "Номер карты".
2. Ввести валидные данные в поля: "Месяц", "Год", "Владелец", "CVC/CVV".
3. Нажать на кнопку "Продолжить".
4. Нажать на крестик у всплывающего окна с сообщением: "Ошибка! Банк отказал в проведении операции"

ОР: уведомление закрыто.

**Тестирование занесения информации в базы данных:**
**22. Проверка создания записи в таблице.(сценарий для обеих форм)**

Шаги:
1. Ввести валидные данные карты.
2. Нажать на кнопку "Продолжить".
3. Нажать на крестик у всплывающего окна с успешным сообщением
4. Проверить БД на наличие записи

ОР: запись в таблице есть.

**23. Проверка статуса записи в таблице(Approved карта).(сценарий для обеих форм)**

Шаги:
1. Ввести валидные данные карты.
2. Нажать на кнопку "Продолжить".
3. Нажать на крестик у всплывающего окна с успешным сообщением
4. Проверить БД на наличие записи со статусом "APPROVED"

ОР: запись в таблице есть.

**24. "Проверка статуса записи в таблице(Declined карта)".(сценарий для обеих форм)**

Шаги:
1. Ввести валидные данные карты.
2. Нажать на кнопку "Продолжить".
3. Нажать на крестик у всплывающего окна с успешным сообщением
4. Проверить БД на наличие записи со статусом "DECLINED"

ОР: запись в таблице есть.

### Используемые инструменты

- MacOS Big Sur версия 11.6 intel Core i7
- java 11 - версия популярного языка программирования
- Intellij IDEA 2021.2.1 Community edition - интегрированная среда разработки программного обеспечения для многих языков программирования, в том числе Java
- Gradle - средство автоматизации сборки проектов, позволяет легко собрать билд со всеми зависимостями, а также генерирует отчеты по тестированию
- JUnit 5 - популярный тестовый фреймворк с вложенными и параметризованными тестами
- Selenide - инструмент для автоматизации действия пользователя в браузере, ориентированный на удобство и легкость реализации бизнес-логики в автотестах
- Faker - библиотека, необходимая для генерации рандомных тестовых данных, позволяет не придумывать и не прописывать вручную наборы тестовых данных
- Rest Assured - java-библиотека для тестирования REST API, позволяет автоматизировать тестирование get и post запросов
- Allure - фреймворк для создания отчетов о тестировании, для наглядного отоображения прохождения тестов и ошибок
- Docker - для развертывания виртуальных контейнеров баз данных, а также эмулятора сервисов банка на NodeJS 
- Lombok - плагин, предоставляет аннотации, позволяющие сократить время написания кода 
- Appveyor - система CI CD
- Postman –для проверки запросов к API (ручное)

### Возможные риски при автоматизации

1. Отсутствие документации и чёткого ТЗ, что может привести к ошибке в работе реального приложения
2. Общее время, затраченное на автоматизацию может превышать общее время ручного тестирования, и быть очень трудозатратным
3. Необходимость поддержки тестов (затратно если их незначительное количество)
4. Изменения в веб-интерфейсе тестируемой страницы - необходимо вносить изменения в код автотестов с использованием selenide.
5. Изменения в данных таблиц БД (добавляются/удаляются поля в таблице, у каких-то полей может измениться тип данных), требуются изменения в автотесты, связанные с Rest Assured.
6. Падение тестовой среды либо используемой API (статус 500) - все автотесты упадут

### Интервальная оценка с учётом рисков (в часах)###

- Написание плана автоматизации: 8 часов;
- Настройка тестового окружения: 4 часа;
- Написание и отладка автотестов: 24 часа;
- Прогон тестов и заведение баг репортов: 4 часа;
- Устранение замечаний: 6 часов;
- Написание отчета по итогам тестирования: 3 часа;
- Подготовка отчета по итогом автоматизации: 1 час

**Итого: 50 часов**

### План сдачи работ

1. Планирование: 23.10.2021 - 24.10.2021
2. Автоматизация: подключение окружения, написание автотестов и заведение issue: 29.10.2021
3. Отчет по тестированию: 30.10.2021
4. Отчет по автоматизации: 31.10.2021
